!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).FloatingUICore={})}(this,(function(t){"use strict";function e(t){return t.split("-")[1]}function n(t){return"y"===t?"height":"width"}function o(t){return t.split("-")[0]}function r(t){return["top","bottom"].includes(o(t))?"x":"y"}function i(t,i,l){let{reference:s,floating:f}=t;const a=s.x+s.width/2-f.width/2,c=s.y+s.height/2-f.height/2,u=r(i),m=n(u),d=s[m]/2-f[m]/2,g="x"===u;let p;switch(o(i)){case"top":p={x:a,y:s.y-f.height};break;case"bottom":p={x:a,y:s.y+s.height};break;case"right":p={x:s.x+s.width,y:c};break;case"left":p={x:s.x-f.width,y:c};break;default:p={x:s.x,y:s.y}}switch(e(i)){case"start":p[u]-=d*(l&&g?-1:1);break;case"end":p[u]+=d*(l&&g?-1:1)}return p}function l(t,e){return"function"==typeof t?t(e):t}function s(t){return"number"!=typeof t?function(t){return{top:0,right:0,bottom:0,left:0,...t}}(t):{top:t,right:t,bottom:t,left:t}}function f(t){return{...t,top:t.y,left:t.x,right:t.x+t.width,bottom:t.y+t.height}}function a(t,e){var n;void 0===e&&(e={});const{x:o,y:r,platform:i,rects:a,elements:c,strategy:u}=t,{boundary:m="clippingAncestors",rootBoundary:d="viewport",elementContext:g="floating",altBoundary:p=!1,padding:h=0}=l(e,t),y=s(h),x=c[p?"floating"===g?"reference":"floating":g],v=f(i.getClippingRect({element:null==(n=null==i.isElement?void 0:i.isElement(x))||n?x:x.contextElement||(null==i.getDocumentElement?void 0:i.getDocumentElement(c.floating)),boundary:m,rootBoundary:d,strategy:u})),b="floating"===g?{...a.floating,x:o,y:r}:a.reference,w=null==i.getOffsetParent?void 0:i.getOffsetParent(c.floating),A=null!=i.isElement&&i.isElement(w)&&(null==i.getScale?void 0:i.getScale(w))||{x:1,y:1},R=f(i.convertOffsetParentRelativeRectToViewportRelativeRect?i.convertOffsetParentRelativeRectToViewportRelativeRect({rect:b,offsetParent:w,strategy:u}):b);return{top:(v.top-R.top+y.top)/A.y,bottom:(R.bottom-v.bottom+y.bottom)/A.y,left:(v.left-R.left+y.left)/A.x,right:(R.right-v.right+y.right)/A.x}}const c=Math.min,u=Math.max;function m(t,e,n){return u(t,c(e,n))}const d=["top","right","bottom","left"],g=d.reduce(((t,e)=>t.concat(e,e+"-start",e+"-end")),[]),p={left:"right",right:"left",bottom:"top",top:"bottom"};function h(t){return t.replace(/left|right|bottom|top/g,(t=>p[t]))}function y(t,o,i){void 0===i&&(i=!1);const l=e(t),s=r(t),f=n(s);let a="x"===s?l===(i?"end":"start")?"right":"left":"start"===l?"bottom":"top";return o.reference[f]>o.floating[f]&&(a=h(a)),{main:a,cross:h(a)}}const x={start:"end",end:"start"};function v(t){return t.replace(/start|end/g,(t=>x[t]))}function b(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function w(t){return d.some((e=>t[e]>=0))}function A(t){const e=c(...t.map((t=>t.left))),n=c(...t.map((t=>t.top)));return{x:e,y:n,width:u(...t.map((t=>t.right)))-e,height:u(...t.map((t=>t.bottom)))-n}}function R(t){return"x"===t?"y":"x"}t.arrow=t=>({name:"arrow",options:t,fn(o){const{x:i,y:f,placement:a,rects:u,platform:d,elements:g}=o,{element:p,padding:h=0}=l(t,o)||{};if(null==p)return{};const y=s(h),x={x:i,y:f},v=r(a),b=n(v),w=d.getDimensions(p),A="y"===v,R=A?"top":"left",P=A?"bottom":"right",T=A?"clientHeight":"clientWidth",E=u.reference[b]+u.reference[v]-x[v]-u.floating[b],D=x[v]-u.reference[v],L=null==d.getOffsetParent?void 0:d.getOffsetParent(p);let O=L?L[T]:0;O&&null!=d.isElement&&d.isElement(L)||(O=g.floating[T]||u.floating[b]);const k=E/2-D/2,C=O/2-w[b]/2-1,B=c(y[R],C),H=c(y[P],C),S=B,F=O-w[b]-H,j=O/2-w[b]/2+k,z=m(S,j,F),M=null!=e(a)&&j!=z&&u.reference[b]/2-(j<S?B:H)-w[b]/2<0?j<S?S-j:F-j:0;return{[v]:x[v]-M,data:{[v]:z,centerOffset:j-z+M}}}}),t.autoPlacement=function(t){return void 0===t&&(t={}),{name:"autoPlacement",options:t,fn(n){var r,i,s;const{rects:f,middlewareData:c,placement:u,platform:m,elements:d}=n,{crossAxis:p=!1,alignment:h,allowedPlacements:x=g,autoAlignment:b=!0,...w}=l(t,n),A=void 0!==h||x===g?function(t,n,r){return(t?[...r.filter((n=>e(n)===t)),...r.filter((n=>e(n)!==t))]:r.filter((t=>o(t)===t))).filter((o=>!t||e(o)===t||!!n&&v(o)!==o))}(h||null,b,x):x,R=a(n,w),P=(null==(r=c.autoPlacement)?void 0:r.index)||0,T=A[P];if(null==T)return{};const{main:E,cross:D}=y(T,f,null==m.isRTL?void 0:m.isRTL(d.floating));if(u!==T)return{reset:{placement:A[0]}};const L=[R[o(T)],R[E],R[D]],O=[...(null==(i=c.autoPlacement)?void 0:i.overflows)||[],{placement:T,overflows:L}],k=A[P+1];if(k)return{data:{index:P+1,overflows:O},reset:{placement:k}};const C=O.map((t=>{const n=e(t.placement);return[t.placement,n&&p?t.overflows.slice(0,2).reduce(((t,e)=>t+e),0):t.overflows[0],t.overflows]})).sort(((t,e)=>t[1]-e[1])),B=(null==(s=C.filter((t=>t[2].slice(0,e(t[0])?2:3).every((t=>t<=0))))[0])?void 0:s[0])||C[0][0];return B!==u?{data:{index:P+1,overflows:O},reset:{placement:B}}:{}}}},t.computePosition=(t,e,n)=>{const{placement:o="bottom",strategy:r="absolute",middleware:l=[],platform:s}=n,f=l.filter(Boolean),a=null==s.isRTL?void 0:s.isRTL(e);let c=s.getElementRects({reference:t,floating:e,strategy:r}),{x:u,y:m}=i(c,o,a),d=o,g={},p=0;for(let n=0;n<f.length;n++){const{name:l,fn:h}=f[n],{x:y,y:x,data:v,reset:b}=h({x:u,y:m,initialPlacement:o,placement:d,strategy:r,middlewareData:g,rects:c,platform:s,elements:{reference:t,floating:e}});u=null!=y?y:u,m=null!=x?x:m,g={...g,[l]:{...g[l],...v}},b&&p<=50&&(p++,"object"==typeof b&&(b.placement&&(d=b.placement),b.rects&&(c=!0===b.rects?s.getElementRects({reference:t,floating:e,strategy:r}):b.rects),({x:u,y:m}=i(c,d,a))),n=-1)}return{x:u,y:m,placement:d,strategy:r,middlewareData:g}},t.detectOverflow=a,t.flip=function(t){return void 0===t&&(t={}),{name:"flip",options:t,fn(n){var r;const{placement:i,middlewareData:s,rects:f,initialPlacement:c,platform:u,elements:m}=n,{mainAxis:d=!0,crossAxis:g=!0,fallbackPlacements:p,fallbackStrategy:x="bestFit",fallbackAxisSideDirection:b="none",flipAlignment:w=!0,...A}=l(t,n),R=o(i),P=o(c)===c,T=null==u.isRTL?void 0:u.isRTL(m.floating),E=p||(P||!w?[h(c)]:function(t){const e=h(t);return[v(t),e,v(e)]}(c));p||"none"===b||E.push(...function(t,n,r,i){const l=e(t);let s=function(t,e,n){const o=["left","right"],r=["right","left"],i=["top","bottom"],l=["bottom","top"];switch(t){case"top":case"bottom":return n?e?r:o:e?o:r;case"left":case"right":return e?i:l;default:return[]}}(o(t),"start"===r,i);return l&&(s=s.map((t=>t+"-"+l)),n&&(s=s.concat(s.map(v)))),s}(c,w,b,T));const D=[c,...E],L=a(n,A),O=[];let k=(null==(r=s.flip)?void 0:r.overflows)||[];if(d&&O.push(L[R]),g){const{main:t,cross:e}=y(i,f,T);O.push(L[t],L[e])}if(k=[...k,{placement:i,overflows:O}],!O.every((t=>t<=0))){var C,B;const t=((null==(C=s.flip)?void 0:C.index)||0)+1,e=D[t];if(e)return{data:{index:t,overflows:k},reset:{placement:e}};let n=null==(B=k.filter((t=>t.overflows[0]<=0)).sort(((t,e)=>t.overflows[1]-e.overflows[1]))[0])?void 0:B.placement;if(!n)switch(x){case"bestFit":{var H;const t=null==(H=k.map((t=>[t.placement,t.overflows.filter((t=>t>0)).reduce(((t,e)=>t+e),0)])).sort(((t,e)=>t[1]-e[1]))[0])?void 0:H[0];t&&(n=t);break}case"initialPlacement":n=c}if(i!==n)return{reset:{placement:n}}}return{}}}},t.hide=function(t){return void 0===t&&(t={}),{name:"hide",options:t,fn(e){const{rects:n}=e,{strategy:o="referenceHidden",...r}=l(t,e);switch(o){case"referenceHidden":{const t=b(a(e,{...r,elementContext:"reference"}),n.reference);return{data:{referenceHiddenOffsets:t,referenceHidden:w(t)}}}case"escaped":{const t=b(a(e,{...r,altBoundary:!0}),n.floating);return{data:{escapedOffsets:t,escaped:w(t)}}}default:return{}}}}},t.inline=function(t){return void 0===t&&(t={}),{name:"inline",options:t,fn(e){const{placement:n,elements:i,rects:a,platform:m,strategy:d}=e,{padding:g=2,x:p,y:h}=l(t,e),y=Array.from((null==m.getClientRects?void 0:m.getClientRects(i.reference))||[]),x=function(t){const e=t.slice().sort(((t,e)=>t.y-e.y)),n=[];let o=null;for(let t=0;t<e.length;t++){const r=e[t];!o||r.y-o.y>o.height/2?n.push([r]):n[n.length-1].push(r),o=r}return n.map((t=>f(A(t))))}(y),v=f(A(y)),b=s(g);const w=m.getElementRects({reference:{getBoundingClientRect:function(){if(2===x.length&&x[0].left>x[1].right&&null!=p&&null!=h)return x.find((t=>p>t.left-b.left&&p<t.right+b.right&&h>t.top-b.top&&h<t.bottom+b.bottom))||v;if(x.length>=2){if("x"===r(n)){const t=x[0],e=x[x.length-1],r="top"===o(n),i=t.top,l=e.bottom,s=r?t.left:e.left,f=r?t.right:e.right;return{top:i,bottom:l,left:s,right:f,width:f-s,height:l-i,x:s,y:i}}const t="left"===o(n),e=u(...x.map((t=>t.right))),i=c(...x.map((t=>t.left))),l=x.filter((n=>t?n.left===i:n.right===e)),s=l[0].top,f=l[l.length-1].bottom;return{top:s,bottom:f,left:i,right:e,width:e-i,height:f-s,x:i,y:s}}return v}},floating:i.floating,strategy:d});return a.reference.x!==w.reference.x||a.reference.y!==w.reference.y||a.reference.width!==w.reference.width||a.reference.height!==w.reference.height?{reset:{rects:w}}:{}}}},t.limitShift=function(t){return void 0===t&&(t={}),{options:t,fn(e){const{x:n,y:i,placement:s,rects:f,middlewareData:a}=e,{offset:c=0,mainAxis:u=!0,crossAxis:m=!0}=l(t,e),d={x:n,y:i},g=r(s),p=R(g);let h=d[g],y=d[p];const x=l(c,e),v="number"==typeof x?{mainAxis:x,crossAxis:0}:{mainAxis:0,crossAxis:0,...x};if(u){const t="y"===g?"height":"width",e=f.reference[g]-f.floating[t]+v.mainAxis,n=f.reference[g]+f.reference[t]-v.mainAxis;h<e?h=e:h>n&&(h=n)}if(m){var b,w;const t="y"===g?"width":"height",e=["top","left"].includes(o(s)),n=f.reference[p]-f.floating[t]+(e&&(null==(b=a.offset)?void 0:b[p])||0)+(e?0:v.crossAxis),r=f.reference[p]+f.reference[t]+(e?0:(null==(w=a.offset)?void 0:w[p])||0)-(e?v.crossAxis:0);y<n?y=n:y>r&&(y=r)}return{[g]:h,[p]:y}}}},t.offset=function(t){return void 0===t&&(t=0),{name:"offset",options:t,fn(n){const{x:i,y:s}=n,f=function(t,n){const{placement:i,platform:s,elements:f}=t,a=null==s.isRTL?void 0:s.isRTL(f.floating),c=o(i),u=e(i),m="x"===r(i),d=["left","top"].includes(c)?-1:1,g=a&&m?-1:1,p=l(n,t);let{mainAxis:h,crossAxis:y,alignmentAxis:x}="number"==typeof p?{mainAxis:p,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...p};return u&&"number"==typeof x&&(y="end"===u?-1*x:x),m?{x:y*g,y:h*d}:{x:h*d,y:y*g}}(n,t);return{x:i+f.x,y:s+f.y,data:f}}}},t.rectToClientRect=f,t.shift=function(t){return void 0===t&&(t={}),{name:"shift",options:t,fn(e){const{x:n,y:i,placement:s}=e,{mainAxis:f=!0,crossAxis:c=!1,limiter:u={fn:t=>{let{x:e,y:n}=t;return{x:e,y:n}}},...d}=l(t,e),g={x:n,y:i},p=a(e,d),h=r(o(s)),y=R(h);let x=g[h],v=g[y];if(f){const t="y"===h?"bottom":"right";x=m(x+p["y"===h?"top":"left"],x,x-p[t])}if(c){const t="y"===y?"bottom":"right";v=m(v+p["y"===y?"top":"left"],v,v-p[t])}const b=u.fn({...e,[h]:x,[y]:v});return{...b,data:{x:b.x-n,y:b.y-i}}}}},t.size=function(t){return void 0===t&&(t={}),{name:"size",options:t,fn(n){const{placement:i,rects:s,platform:f,elements:m}=n,{apply:d=(()=>{}),...g}=l(t,n),p=a(n,g),h=o(i),y=e(i),x="x"===r(i),{width:v,height:b}=s.floating;let w,A;"top"===h||"bottom"===h?(w=h,A=y===(null!=f.isRTL&&f.isRTL(m.floating)?"start":"end")?"left":"right"):(A=h,w="end"===y?"top":"bottom");const R=b-p[w],P=v-p[A],T=!n.middlewareData.shift;let E=R,D=P;if(x){const t=v-p.left-p.right;D=y||T?c(P,t):t}else{const t=b-p.top-p.bottom;E=y||T?c(R,t):t}if(T&&!y){const t=u(p.left,0),e=u(p.right,0),n=u(p.top,0),o=u(p.bottom,0);x?D=v-2*(0!==t||0!==e?t+e:u(p.left,p.right)):E=b-2*(0!==n||0!==o?n+o:u(p.top,p.bottom))}d({...n,availableWidth:D,availableHeight:E});const L=f.getDimensions(m.floating);return v!==L.width||b!==L.height?{reset:{rects:!0}}:{}}}}}));
